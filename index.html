
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOR Pi MAXIMUM TRANSACTION - Minimal Demo</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .subtitle {
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }
        .status-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #6c757d;
        }
        .status-box.loading {
            border-left-color: #ffc107;
            background: #fff3cd;
        }
        .status-box.success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .status-box.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .status-text {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }
        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .btn-login {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-login:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-payment {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .btn-payment:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }
        .user-info {
            background: #e7f3ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: none;
        }
        .user-info.show {
            display: block;
        }
        .user-name {
            font-size: 16px;
            font-weight: 700;
            color: #0066cc;
        }
        .log-container {
            background: #1e1e1e;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            text-align: left;
        }
        .log-title {
            color: #fff;
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        .log-entry {
            font-size: 11px;
            font-family: 'Courier New', monospace;
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }
        .log-info {
            color: #61dafb;
        }
        .log-success {
            color: #98c379;
        }
        .log-error {
            color: #e06c75;
        }
        .log-warning {
            color: #e5c07b;
        }
        .icon {
            font-size: 20px;
        }
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: #999;
            font-size: 12px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ¥§ FOR Pi MAXIMUM TRANSACTION</h1>
    <p class="subtitle">Pi Network SDK Integration Demo</p>
    
    <div id="sdkStatus" class="status-box loading">
        <div class="status-text">
            <span class="spinner"></span>
            <span style="margin-left: 10px;">SDK ì´ˆê¸°í™” ì¤‘...</span>
        </div>
    </div>
    
    <div id="userInfo" class="user-info">
        <div class="user-name" id="userName">User: Not logged in</div>
    </div>
    
    <button id="loginBtn" class="btn btn-login" onclick="handleLogin()" disabled>
        <span class="icon">ğŸ”</span>
        <span>Pi Login (Authenticate)</span>
    </button>
    
    <button id="paymentBtn" class="btn btn-payment" onclick="handlePayment()" disabled>
        <span class="icon">ğŸ’°</span>
        <span>Request Payment (0.01 Pi)</span>
    </button>
    
    <div class="log-container">
        <div class="log-title">ğŸ“‹ Activity Log</div>
        <div id="logContent"></div>
    </div>
    
    <div class="footer">
        <div>Testnet Mode | Hackathon Demo</div>
        <div style="margin-top: 5px;">App Key: epc4...5cas</div>
    </div>
</div>

<script>
// ============================================
// Pi SDK í†µí•© (í˜¸ìŠ¤íŒ… í†µê³¼ìš© ìµœì†Œ êµ¬ì„±)
// ============================================

const APP_KEY = "epc4mx46e6y2s6l8bhm1hrcmeuzkbpuprwmvlm5ktfzs2g0pnikqh8pcorkk5cas";
let piSDK = null;
let authenticatedUser = null;

// ë¡œê·¸ í•¨ìˆ˜
function addLog(message, type = 'info') {
    const logContent = document.getElementById('logContent');
    const timestamp = new Date().toLocaleTimeString();
    const logClass = `log-${type}`;
    
    const logEntry = document.createElement('div');
    logEntry.className = `log-entry ${logClass}`;
    logEntry.textContent = `[${timestamp}] ${message}`;
    
    logContent.appendChild(logEntry);
    logContent.scrollTop = logContent.scrollHeight;
    
    console.log(`[${type.toUpperCase()}] ${message}`);
}

// SDK ìƒíƒœ ì—…ë°ì´íŠ¸
function updateSDKStatus(message, status = 'loading') {
    const statusBox = document.getElementById('sdkStatus');
    statusBox.className = `status-box ${status}`;
    
    let icon = 'â³';
    if (status === 'success') icon = 'âœ…';
    if (status === 'error') icon = 'âŒ';
    
    statusBox.innerHTML = `<div class="status-text">${icon} ${message}</div>`;
}

// SDK ì´ˆê¸°í™”
async function initPiSDK() {
    try {
        addLog('Pi SDK ë¡œë”© ì‹œì‘...', 'info');
        
        // Pi SDK ê°ì²´ í™•ì¸
        if (typeof Pi === 'undefined') {
            throw new Error('Pi SDKê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }
        
        piSDK = Pi;
        addLog('Pi SDK ê°ì²´ í™•ì¸ ì™„ë£Œ', 'success');
        
        // SDK ì´ˆê¸°í™”
        addLog(`App Keyë¡œ ì´ˆê¸°í™” ì¤‘... (${APP_KEY.substring(0, 8)}...)`, 'info');
        
        await piSDK.init({
            version: "2.0",
            sandbox: true,
            key: APP_KEY
        });
        
        addLog('âœ“ Pi SDK ì´ˆê¸°í™” ì„±ê³µ!', 'success');
        updateSDKStatus('SDK Ready - ë¡œê·¸ì¸ ê°€ëŠ¥', 'success');
        
        // ë¡œê·¸ì¸ ë²„íŠ¼ í™œì„±í™”
        document.getElementById('loginBtn').disabled = false;
        
    } catch (error) {
        addLog(`SDK ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, 'error');
        updateSDKStatus('SDK ì´ˆê¸°í™” ì‹¤íŒ¨', 'error');
        
        // ì¬ì‹œë„ ë²„íŠ¼ ì¶”ê°€
        const statusBox = document.getElementById('sdkStatus');
        statusBox.innerHTML += `<button onclick="initPiSDK()" style="margin-top: 10px; padding: 5px 15px; border: none; background: #dc3545; color: white; border-radius: 5px; cursor: pointer;">ì¬ì‹œë„</button>`;
    }
}

// ë¯¸ì™„ë£Œ ê²°ì œ ì²˜ë¦¬
function onIncompletePaymentFound(payment) {
    addLog(`ë¯¸ì™„ë£Œ ê²°ì œ ë°œê²¬: ${payment.identifier}`, 'warning');
    return payment;
}

// ë¡œê·¸ì¸ ì²˜ë¦¬
async function handleLogin() {
    if (!piSDK) {
        addLog('SDKê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.', 'error');
        return;
    }
    
    try {
        document.getElementById('loginBtn').disabled = true;
        addLog('Pi ì¸ì¦ ìš”ì²­ ì¤‘...', 'info');
        
        const scopes = ['username', 'payments'];
        const authResult = await piSDK.authenticate(scopes, onIncompletePaymentFound);
        
        authenticatedUser = authResult.user.username;
        const uid = authResult.user.uid || 'N/A';
        
        addLog(`âœ“ ì¸ì¦ ì„±ê³µ! Username: ${authenticatedUser}`, 'success');
        addLog(`UID: ${uid}`, 'info');
        
        // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
        document.getElementById('userName').textContent = `ğŸ‘¤ ${authenticatedUser}`;
        document.getElementById('userInfo').classList.add('show');
        
        // ê²°ì œ ë²„íŠ¼ í™œì„±í™”
        document.getElementById('paymentBtn').disabled = false;
        
        updateSDKStatus(`ë¡œê·¸ì¸ ì™„ë£Œ: ${authenticatedUser}`, 'success');
        
    } catch (error) {
        addLog(`ì¸ì¦ ì‹¤íŒ¨: ${error.message}`, 'error');
        document.getElementById('loginBtn').disabled = false;
        updateSDKStatus('ì¸ì¦ ì‹¤íŒ¨ - ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”', 'error');
    }
}

// ê²°ì œ ì²˜ë¦¬
async function handlePayment() {
    if (!authenticatedUser) {
        addLog('ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
        return;
    }
    
    try {
        document.getElementById('paymentBtn').disabled = true;
        addLog('ê²°ì œ ìš”ì²­ ìƒì„± ì¤‘...', 'info');
        
        const paymentData = {
            amount: 0.01,
            memo: "FOR Pi MAXIMUM TRANSACTION Demo",
            metadata: {
                app: "for-pi-max-tx",
                type: "demo",
                timestamp: Date.now()
            }
        };
        
        const callbacks = {
            onReadyForServerApproval: function(paymentId) {
                addLog(`âœ“ ê²°ì œ ìŠ¹ì¸ ëŒ€ê¸°: ${paymentId}`, 'success');
                addLog('âš ï¸ ë°±ì—”ë“œ ì—†ìŒ: ì‹¤ì œ ì „ì†¡ ë¶ˆê°€ (ë°ëª¨ìš©)', 'warning');
                updateSDKStatus('ê²°ì œ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘...', 'loading');
            },
            onReadyForServerCompletion: function(paymentId, txid) {
                addLog(`âœ“ ê²°ì œ ì™„ë£Œ! TxID: ${txid}`, 'success');
                updateSDKStatus('ê²°ì œ ì™„ë£Œ!', 'success');
                document.getElementById('paymentBtn').disabled = false;
            },
            onCancel: function(paymentId) {
                addLog(`ê²°ì œ ì·¨ì†Œë¨: ${paymentId}`, 'warning');
                updateSDKStatus('ê²°ì œ ì·¨ì†Œë¨', 'error');
                document.getElementById('paymentBtn').disabled = false;
            },
            onError: function(error, payment) {
                addLog(`ê²°ì œ ì—ëŸ¬: ${error.message}`, 'error');
                updateSDKStatus('ê²°ì œ ì—ëŸ¬ ë°œìƒ', 'error');
                document.getElementById('paymentBtn').disabled = false;
            }
        };
        
        addLog(`ê²°ì œ ê¸ˆì•¡: ${paymentData.amount} Pi`, 'info');
        const payment = piSDK.createPayment(paymentData, callbacks);
        
        addLog('Pi ì•±ì—ì„œ ê²°ì œë¥¼ í™•ì¸í•˜ì„¸ìš”.', 'info');
        updateSDKStatus('Pi ì•±ì—ì„œ ê²°ì œ í™•ì¸ ì¤‘...', 'loading');
        
    } catch (error) {
        addLog(`ê²°ì œ ìš”ì²­ ì‹¤íŒ¨: ${error.message}`, 'error');
        updateSDKStatus('ê²°ì œ ìš”ì²­ ì‹¤íŒ¨', 'error');
        document.getElementById('paymentBtn').disabled = false;
    }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì´ˆê¸°í™”
window.addEventListener('DOMContentLoaded', function() {
    addLog('=== FOR Pi MAXIMUM TRANSACTION Demo ===', 'info');
    addLog('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'info');
    
    // SDK ë¡œë“œ ëŒ€ê¸° í›„ ì´ˆê¸°í™”
    if (typeof Pi !== 'undefined') {
        initPiSDK();
    } else {
        addLog('Pi SDK ë¡œë“œ ëŒ€ê¸° ì¤‘...', 'warning');
        setTimeout(initPiSDK, 1000);
    }
});

// ì—ëŸ¬ í•¸ë“¤ë§
window.addEventListener('error', function(e) {
    addLog(`ì „ì—­ ì—ëŸ¬: ${e.message}`, 'error');
});
</script>
</body>
</html>
